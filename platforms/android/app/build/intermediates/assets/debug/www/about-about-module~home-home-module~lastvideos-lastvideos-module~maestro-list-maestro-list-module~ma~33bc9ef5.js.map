{"version":3,"sources":["webpack:///./src/app/services/video/video.ts"],"names":[],"mappings":"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","file":"about-about-module~home-home-module~lastvideos-lastvideos-module~maestro-list-maestro-list-module~ma~33bc9ef5.js","sourcesContent":["import { Injectable } from '@angular/core';\nimport {Platform,LoadingController } from '@ionic/angular';\nimport * as firebase from 'firebase';\nimport { ProfileProvider } from '../../services/profile/profile';\nimport { MaestroProvider } from '../../services/maestro/maestro';\nimport { IVideo } from '../../interfaces/Video';\nimport { AngularFireDatabase } from 'angularfire2/database';\n\n/*\n  Generated class for the VideoProvider provider.\n\n  See https://angular.io/guide/dependency-injection for more info on providers\n  and Angular DI.\n*/\n@Injectable({\n  providedIn: 'root',\n})\nexport class VideoProvider {\n\n\n  public videos  = new Array<IVideo>();\n  topVideos=[];\n  allVideos=[];\n  allMilongas=[];\n  allVals=[];\n  allOthers=[];\n  allLessons=[];\n  limitOffset=12;\n\n  constructor( \n    private loadingCtrl: LoadingController,\n    public profileService:ProfileProvider,\n    public maestroService:MaestroProvider,\n    public platform:Platform,\n    \n  ) {\n  }\n  \n  launchVideo(video){\n    window.open(\"https://www.youtube.com/watch?v=\"+video.youtubeId);\n  }\n\n\n  getVideos(maestro,type=\"\",offset=0,topvideos=false):Promise<any>{\n    return new Promise((resolve)=>{\n\n\n      if(maestro==null){\n        if(type==null){\n          if(topvideos==true){\n            //affiche les top videos\n            var fb=firebase.database().ref(`/videos`).orderByChild(\"topVideo\").equalTo(1).limitToLast(offset+12);\n            \n          }else{\n            //vue par dÃ©faut\n            var fb=firebase.database().ref(`/videos`).orderByChild(\"datePublication\").limitToLast(offset+12);\n          }\n        }else{\n          var fb=firebase.database().ref(`/videos`).orderByChild(\"type\").equalTo(type).limitToLast(offset+12);\n        }\n      }else{\n        if(type==null){\n          var fb=firebase.database().ref(\"maestros/\"+maestro.key +\"/videos\").orderByChild(\"datePublication\").limitToLast(offset+12);\n        }else{\n          var fb=firebase.database().ref(\"maestros/\"+maestro.key +\"/videos\").orderByChild(\"type\").equalTo(type).limitToLast(offset+12);\n        }\n      }\n     \n\n      var videosWatched=this.profileService.getVideosWatched();\n      \n      fb.once(\"value\")\n      .then((querySnapshot) => {\n        let arr=[];\n        let arrTop=[];\n        \n        querySnapshot.forEach(function (doc) {  \n          var video = <IVideo>{\n            key: doc.key,\n            id:doc.child(\"id\").val(),\n            title:doc.child(\"title\").val(),\n            youtubeId:doc.child(\"youtubeId\").val(),\n            urlImage:doc.child(\"urlImage\").val(),\n            datePublication:doc.child(\"datePublication\").val(),\n            description:doc.child(\"description\").val(),\n            importUser:doc.child(\"importUser\").val(),\n            topVideo:doc.child(\"topVideo\").val(),\n            type:doc.child(\"type\").val(),\n            valid:doc.child(\"valid\").val(),\n            dateAdd:doc.child(\"dateAdd\").val(),\n            seen:false\n          };\n          \n          //Si la video est dans le tableau des vues on la passe en seen true\n          if(videosWatched.indexOf(video.youtubeId)>-1){\n            video.seen=true;\n          }\n\n          if(video.valid){\n            arr.push(video);\n          }\n          \n        });\n        \n        if (arr.length > 0) {\n          resolve(arr.reverse());\n        } else {\n            resolve([]);\n        }\n\n      });\n    \n    });\n  }\n\n\n\n\n\n  loadAllVideos(): Promise<any>{\n    return new Promise((resolve, reject) => {\n\n      firebase.database()\n        .ref(`/videos`)\n        .orderByChild(\"datePublication\")\n        //.limitToLast(8000)\n        .once(\"value\")\n        .then((querySnapshot) => {\n          let arr=[];\n          let arrTop=[];\n\n          querySnapshot.forEach(function (doc) {  \n\n            var video = <IVideo>{\n              key: doc.key,\n              id:doc.child(\"id\").val(),\n              title:doc.child(\"title\").val(),\n              youtubeId:doc.child(\"youtubeId\").val(),\n              urlImage:doc.child(\"urlImage\").val(),\n              datePublication:doc.child(\"datePublication\").val(),\n              description:doc.child(\"description\").val(),\n              importUser:doc.child(\"importUser\").val(),\n              topVideo:doc.child(\"topVideo\").val(),\n              type:doc.child(\"type\").val(),\n              valid:doc.child(\"valid\").val(),\n              dateAdd:doc.child(\"dateAdd\").val(),\n              seen:false\n            };\n            \n            if(video.valid){\n              arr.push(video);\n              if(video.topVideo)arrTop.push(video);\n            }\n            \n          });\n  \n          if (arr.length > 0) {\n\n            this.allVideos=arr;\n            this.topVideos=arrTop;\n            this.allVideos.reverse();\n            resolve(this.allVideos);\n          } else {\n              resolve(null);\n          }\n  \n        });\n    });\n  }\n\n\n  addToVideos(video){\n    this.allVideos.unshift(video);\n  }\n\n  setVideos(videos){\n    this.allVideos=videos;\n\n    for(let video of this.allVideos){\n      if(video.type==\"milonga\")this.allMilongas.push(video);\n      if(video.type==\"vals\")this.allVals.push(video);\n      if(video.type==\"other\")this.allOthers.push(video);\n      if(video.type==\"lesson\")this.allLessons.push(video);\n    }\n\n  } \n\n\n  getAllVideos(){\n    return this.allVideos;\n  }\n\n\n\n  async presentLoading(message) {\n    let loader = await this.loadingCtrl.create({\n      message: message,\n      duration: 500\n    });\n    await loader.present();\n  }\n\n\n  getTopvideos(offset){\n    return this.topVideos.slice(offset,offset+this.limitOffset);\n  }\n\n  setTopVideos(videos){\n    this.topVideos=videos;\n  }\n\n  addTopVideo(video){\n    this.presentLoading(\"Setting as a top video\");\n    video.topVideo=1;\n    firebase.database().ref(`/videos/${video.key}`).set(video);\n    this.topVideos.unshift(video);\n  }\n\n  removeTopVideo(video){\n    video.topVideo=0;\n    firebase.database().ref(`/videos/${video.key}`).set(video);\n  }\n\n  playVideo(video){\n    video.seen=true;\n    this.profileService.setVideoSeen(video);\n    window.open(\"https://www.youtube.com/watch?v=\"+video.youtubeId);\n  }\n\n  setType(video,type){\n    video.type=type;\n\n    this.maestroService.getMaestros().forEach(maestro => {\n      this.findVideo(video,\"maestros/\"+maestro.key+\"/videos\",\"setType\",type).then();\n    });\n\n    //delete video from general\n    this.findVideo(video,\"videos\",\"setType\",type).then();\n\n    return true;\n  }\n\n  deleteVideo(video){\n    //delete video from maestros\n    this.maestroService.getMaestros().forEach(maestro => {\n      this.findVideo(video,\"maestros/\"+maestro.key+\"/videos\",\"delete\",null).then();\n    });\n\n    //delete video from general\n    this.deleteGeneralVideo(video);\n  }\n\n  deleteGeneralVideo(video){\n    firebase.database().ref(\"videos/\"+video.key).set(null);\n    console.log(\"deleting video \"+video.title);\n  }\n\n\n  findVideo(video,target,operation,type): Promise<any>{\n    return new Promise((resolve, reject) => {\n  \n      //trouve la video \n      firebase.database()\n        .ref(target)\n        .orderByChild(\"youtubeId\")\n        .equalTo(video.youtubeId)\n        .once(\"value\")\n        .then((querySnapshot) => {\n          querySnapshot.forEach(function (doc) {\n            if(operation==\"delete\"){\n              video.valid=0;\n              firebase.database().ref(target+\"/\"+doc.key).set(video);\n              console.log(\"deleting \"+video.title);\n            }\n\n            if(operation==\"setType\"){\n              video.type=type;\n              firebase.database().ref(target+\"/\"+doc.key).set(video);\n            }\n          });\n\n        });\n    });\n  }\n\n\n}\n"],"sourceRoot":""}